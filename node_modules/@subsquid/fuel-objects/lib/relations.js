"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setUpRelations = void 0;
const util_internal_1 = require("@subsquid/util-internal");
function setUpRelations(block) {
    block.transactions.sort((a, b) => a.index - b.index);
    block.receipts.sort((a, b) => a.transactionIndex - b.transactionIndex || a.index - b.index);
    block.inputs.sort((a, b) => a.transactionIndex - b.transactionIndex || a.index - b.index);
    block.outputs.sort((a, b) => a.transactionIndex - b.transactionIndex || a.index - b.index);
    let txs = new Array(((0, util_internal_1.maybeLast)(block.transactions)?.index ?? -1) + 1);
    for (let tx of block.transactions) {
        txs[tx.index] = tx;
    }
    for (let receipt of block.receipts) {
        let tx = txs[receipt.transactionIndex];
        if (tx) {
            receipt.transaction = tx;
            tx.receipts.push(receipt);
        }
    }
    for (let input of block.inputs) {
        let tx = txs[input.transactionIndex];
        if (tx) {
            input.transaction = tx;
            tx.inputs.push(input);
        }
    }
    for (let output of block.outputs) {
        let tx = txs[output.transactionIndex];
        if (tx) {
            output.transaction = tx;
            tx.outputs.push(output);
        }
    }
}
exports.setUpRelations = setUpRelations;
//# sourceMappingURL=relations.js.map